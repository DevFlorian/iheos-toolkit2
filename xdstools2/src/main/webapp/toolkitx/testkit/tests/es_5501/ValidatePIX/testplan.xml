<TestPlan>
    <Test>es_5501/validatePIX</Test>
    <TestStep id="validate QBP^Q23 query message">
        <Goal>Validate messages sent from Edge Server</Goal>
        <ExpectedStatus>Success</ExpectedStatus>
        <Hl7v2Validation>
            <UseReport reportName="hashId" section="validateADT" step="validate_ADT_message" useAs="$hashId$"/>
            <SimHl7v2Transaction id="rr" transaction="QBP^Q23^QBP_Q21" msg="Request"/>
            <Assertions>
                <Assert id="MSH 3: Sending Application" process="Required"/>
                <Assert id="MSH 4: Sending Facility" process="Required"/>
                <Assert id="MSH 5: Receiving Application" process="Required"/>
                <Assert id="MSH 6: Receiving Facility" process="Required"/>
                <Assert id="MSH 7: Date/Time of Message" process="Required"/>
                <Assert id="MSH 9: Message Type" process="Equals">QBP</Assert>
                <Assert id="MSH 9-1: Message Type" process="Equals">Q23</Assert>
                <Assert id="MSH 9-2: Message Type" process="Equals">QBP_Q21</Assert>
                <Assert id="MSH 10: Message Control ID" process="Required"/>
                <Assert id="MSH 11: Processing ID" process="Equals">P</Assert>
                <Assert id="MSH 12: Version ID" process="Equals">2.5</Assert>
                <Assert id="QPD 1: Msg Query Name" process="Equals">IHE PIX Query</Assert>
                <Assert id="QPD 2: Query Tag" process="Required"/>
                <Assert id="QPD 3: Person Identifier" process="Equals">$hashId$</Assert>
                <Assert id="QPD 3.3.1: Assigning Authority UID" process="Equals">1.3.6.1.4.1.19376.2.840.1.1.1.1</Assert>
                <Assert id="QPD 3.3.2: Assigning Authority Type" process="Equals">ISO</Assert>
                <Assert id="QPD 4.3.1: Assigning Authority UID" process="Equals">Fixed_TBD</Assert>
                <Assert id="QPD 4.3.2: Assigning Authority Type" process="Equals">ISO</Assert>
                <Assert id="RCP 2: Query Priority" process="Equals">I</Assert>
            </Assertions>
        </Hl7v2Validation>
    </TestStep>
    <TestStep id="saveReturnedId">
        <Goal>Save the pid returned by the query</Goal>
        <ExpectedStatus>Success</ExpectedStatus>
        <Hl7v2Validation>
            <SimHl7v2Transaction id="rr" transaction="QBP^Q23^QBP_Q21" msg="Response"/>
            <Assertions>
                <Assert id="PID 3: Returned Identifier" process="Required" reportAs="returnedId"/>
            </Assertions>
        </Hl7v2Validation>
    </TestStep>
</TestPlan>